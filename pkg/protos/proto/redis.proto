syntax = "proto3";

package brz;

import "google/protobuf/empty.proto";
import "domain.proto";

option go_package = "github.com/autumnterror/breezynotes;brzrpc";


// Cache payloads
message NoteListByUser { string user_id = 1; repeated NotePart items = 2; }
message NotesByUser { string user_id = 1; repeated Note items = 2; }
message NoteByUser { string user_id = 1; NoteWithBlocks note = 2; }
message TagsByUser { string user_id = 1; repeated Tag items = 2; }
message BlocksOnNote { string note_id = 1; repeated Block items = 2; }

message UserNoteId {
  string userId = 1;
  string noteId = 2;
}

service RedisService {
  rpc GetNoteByUser(UserNoteId) returns (NoteWithBlocks);
  rpc GetNoteListByUser(UserId) returns (NoteParts);
  rpc GetNotesFromTrashByUser(UserId) returns (NoteParts);
  rpc GetTagsByUser(UserId) returns (Tags);

  rpc SetTagsByUser(TagsByUser) returns (google.protobuf.Empty);
  rpc SetNoteByUser(NoteByUser) returns (google.protobuf.Empty);
  rpc SetNotesFromTrashByUser(NoteListByUser) returns (google.protobuf.Empty);
  rpc SetNoteListByUser(NoteListByUser) returns (google.protobuf.Empty);

  rpc RmTagsByUser(UserId) returns (google.protobuf.Empty);
  rpc RmNoteByUser(UserNoteId) returns (google.protobuf.Empty);
  rpc RmNotesFromTrashByUser(UserId) returns (google.protobuf.Empty);
  rpc RmNoteListByUser(UserId) returns (google.protobuf.Empty);


  rpc Healthz(google.protobuf.Empty) returns (google.protobuf.Empty);
}
